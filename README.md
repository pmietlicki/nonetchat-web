# NoNetChat Web

> üåç **[English version available](README.en.md)** | **Version fran√ßaise**

Une application de messagerie hyperlocale utilisant les technologies web les plus avanc√©es pour une communication P2P s√©curis√©e, g√©olocalis√©e et respectueuse de la vie priv√©e.

## üåü Vision du Projet

NoNetChat Web est une application de messagerie **hyperlocale** et **g√©olocalis√©e** qui privil√©gie :
- **Confidentialit√© totale** : Chiffrement end-to-end, aucune donn√©e stock√©e sur serveur
- **Communication P2P** : Connexions directes via WebRTC pour une latence minimale
- **D√©couverte g√©ographique** : Trouvez des personnes dans votre zone g√©ographique
- **Contr√¥le utilisateur** : Vous ma√Ætrisez vos donn√©es et vos connexions
- **M√©dias riches** : Support complet des fichiers, images, notes vocales

## üöÄ Fonctionnalit√©s Principales

### üí¨ Messagerie Avanc√©e
- **Messages temps r√©el** : Communication instantan√©e avec indicateurs de frappe
- **Statuts de messages** : Envoy√©, livr√©, lu avec horodatage pr√©cis
- **R√©actions aux messages** : Syst√®me d'√©mojis et r√©actions rapides
- **Notes vocales** : Enregistrement et lecture de messages audio
- **Transfert de fichiers** : Partage s√©curis√© jusqu'√† 100MB par fichier
- **Pr√©visualisation m√©dias** : Aper√ßu int√©gr√© des images et fichiers

### üåç D√©couverte G√©ographique
- **Localisation intelligente** : GPS pr√©cis avec fallback g√©olocalisation IP
- **Recherche par proximit√©** : Rayon configurable ou par ville/pays
- **Quadtree spatial** : Algorithme optimis√© pour la d√©couverte g√©ographique
- **Salles publiques** : Chat √©ph√©m√®re par zone g√©ographique
- **Respect de la vie priv√©e** : Localisation approximative uniquement

### üîí S√©curit√© & Confidentialit√©
- **Chiffrement end-to-end** : AES-GCM avec cl√©s ECDH √©ph√©m√®res
- **Pas de serveur central** : Donn√©es stock√©es uniquement localement
- **Connexions P2P** : WebRTC pour communication directe
- **Anonymat** : Aucune inscription, identifiants √©ph√©m√®res
- **Contr√¥le total** : Blocage, suppression, gestion des donn√©es

### üì± Interface Utilisateur
- **Design moderne** : Interface responsive Material Design
- **PWA compl√®te** : Installation native, notifications push
- **Multi-langues** : Support fran√ßais, anglais, espagnol, allemand, italien
- **Th√®me adaptatif** : Interface optimis√©e mobile/desktop
- **Accessibilit√©** : Support complet des technologies d'assistance

## üèóÔ∏è Architecture Technique

### Frontend (React + TypeScript + Vite)

#### Services Principaux
- **PeerService** : Gestion WebRTC, d√©couverte pairs, √©change messages
- **CryptoService** : Chiffrement AES-GCM, cl√©s ECDH, compression Gzip
- **IndexedDBService** : Base de donn√©es locale, migrations, cache
- **ProfileService** : Profil utilisateur, avatar, pr√©f√©rences
- **NotificationService** : Notifications push, sons, badges
- **FileService** : Traitement fichiers, miniatures, validation
- **DiagnosticService** : Logs, tests connectivit√©, debug

#### Composants Interface
- **ChatWindow** : Interface de chat avec r√©actions, fichiers, vocal
- **PeerList** : Liste des pairs avec filtres et tri g√©ographique
- **ConversationList** : Historique conversations avec recherche
- **PublicChatWindow** : Chat public √©ph√©m√®re par zone
- **ProfileModal** : Gestion profil utilisateur complet
- **DiagnosticPanel** : Outils de diagnostic et debug

#### Technologies Frontend
- **React 18** : Framework UI avec hooks modernes
- **TypeScript** : Typage statique pour robustesse
- **Vite** : Build tool ultra-rapide avec HMR
- **Lucide React** : Ic√¥nes SVG optimis√©es
- **Web APIs** : WebRTC, IndexedDB, Geolocation, Push API

### Backend (Node.js + Express)

#### Serveur de Signalisation
- **WebSocket Server** : Signalisation WebRTC et d√©couverte pairs
- **API REST** : Endpoints TURN, GeoIP, notifications push
- **Quadtree Spatial** : Indexation g√©ographique optimis√©e
- **GeoIP MaxMind** : G√©olocalisation par adresse IP
- **TURN/STUN** : Serveurs de relais pour NAT traversal

#### Fonctionnalit√©s Serveur
- **D√©couverte g√©ographique** : Algorithme quadtree pour proximit√©
- **Salles publiques** : Chat √©ph√©m√®re avec TTL et limites
- **Push notifications** : VAPID pour notifications web
- **S√©curit√© CORS** : Whitelist domaines autoris√©s
- **Monitoring** : Heartbeat, nettoyage connexions

#### Technologies Backend
- **Node.js** : Runtime JavaScript serveur
- **Express** : Framework web minimaliste
- **WebSocket (ws)** : Communication temps r√©el
- **MaxMind GeoIP2** : Base de donn√©es g√©olocalisation
- **Web Push** : Notifications push VAPID
- **Quadtree-js** : Structure de donn√©es spatiale

## üõ†Ô∏è Installation

### Pr√©requis
- **Node.js 18+** : Runtime JavaScript moderne
- **npm ou yarn** : Gestionnaire de paquets
- **Navigateur moderne** : Chrome 97+, Firefox 100+, Safari 16+

### Installation Rapide

```bash
# Cloner le repository
git clone https://github.com/your-username/nonetchat-web.git
cd nonetchat-web

# Installation des d√©pendances frontend
npm install

# Installation des d√©pendances backend
cd server
npm install
cd ..
```

### D√©marrage D√©veloppement

```bash
# Terminal 1 : Serveur backend
cd server
npm run dev

# Terminal 2 : Frontend
npm run dev
```

L'application sera accessible sur `http://localhost:5173`

## üöÄ Utilisation

### Premi√®re Connexion
1. **Autoriser la g√©olocalisation** : Pour d√©couvrir les pairs √† proximit√©
2. **Configurer votre profil** : Nom, √¢ge, avatar (optionnel)
3. **D√©couvrir les pairs** : Liste automatique des utilisateurs connect√©s
4. **D√©marrer une conversation** : Clic sur un pair pour chatter

### Fonctionnalit√©s Avanc√©es
- **Chat public** : Rejoindre les discussions de votre zone
- **Transfert de fichiers** : Glisser-d√©poser ou s√©lection
- **Notes vocales** : Maintenir le bouton micro
- **R√©actions** : Clic long sur un message
- **Param√®tres** : Notifications, rayon de recherche

## üìã Scripts Disponibles

### Frontend
```bash
npm run dev          # Serveur d√©veloppement avec HMR
npm run build        # Build de production optimis√©
npm run preview      # Aper√ßu du build de production
npm run test         # Tests unitaires avec Vitest
npm run test:e2e     # Tests end-to-end avec Playwright
npm run lint         # V√©rification ESLint
npm run type-check   # V√©rification TypeScript
```

### Backend
```bash
npm start            # Serveur production
npm run dev          # Serveur d√©veloppement avec watch
```

## üîß Configuration

### Variables d'Environnement Backend

Cr√©ez un fichier `.env` dans le dossier `server/` :

```env
# Serveur
PORT=3000
NODE_ENV=development

# TURN/STUN (pour WebRTC)
TURN_STATIC_SECRET=your-turn-secret
TURN_HOST=turn.nonetchat.com
TURN_REALM=turn.nonetchat.com
TURN_TTL_SECONDS=3600

# GeoIP (optionnel)
GEOIP_DB=/path/to/GeoLite2-City.mmdb

# Push Notifications (optionnel)
VAPID_PUBLIC_KEY=your-vapid-public-key
VAPID_PRIVATE_KEY=your-vapid-private-key
VAPID_SUB=mailto:contact@nonetchat.com
```

### Configuration Frontend

Les param√®tres sont configurables via l'interface :
- **URL de signalisation** : Serveur WebSocket personnalis√©
- **Rayon de recherche** : Distance ou ville/pays
- **Notifications** : Sons, push, badges
- **Langue** : Interface multilingue

## üåê D√©ploiement

### D√©ploiement Frontend (Vercel/Netlify)

```bash
# Build optimis√©
npm run build

# Le dossier dist/ contient les fichiers statiques
# Configurez votre h√©bergeur pour servir dist/index.html
```

### D√©ploiement Backend (VPS/Cloud)

```bash
# Sur votre serveur
git clone https://github.com/your-username/nonetchat-web.git
cd nonetchat-web/server
npm install --production

# Configuration PM2 (recommand√©)
npm install -g pm2
pm2 start server.js --name "nonetchat-server"
pm2 startup
pm2 save
```

### Configuration HTTPS/WSS

Pour la production, configurez un reverse proxy (Nginx) :

```nginx
server {
    listen 443 ssl http2;
    server_name chat.nonetchat.com;
    
    # Certificats SSL
    ssl_certificate /path/to/cert.pem;
    ssl_private_key /path/to/key.pem;
    
    # WebSocket upgrade
    location / {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

## üß™ Tests

### Tests Unitaires
```bash
# Lancer tous les tests
npm run test

# Tests en mode watch
npm run test:watch

# Coverage d√©taill√©
npm run test:coverage
```

### Tests End-to-End
```bash
# Tests E2E complets
npm run test:e2e

# Tests E2E en mode UI
npm run test:e2e:ui
```

## üìö Documentation Technique

### Architecture des Messages

```typescript
interface Message {
  id: string;                    // UUID unique
  senderId: string;             // ID de l'exp√©diteur
  receiverId: string;           // ID du destinataire
  content: string;              // Contenu du message
  timestamp: number;            // Timestamp Unix
  type: 'text' | 'file';       // Type de message
  encrypted: boolean;           // Chiffrement E2E
  status: 'sending' | 'sent' | 'delivered' | 'read';
  fileData?: FileData;          // M√©tadonn√©es fichier
  reactions?: { [emoji: string]: string[] }; // R√©actions
}
```

### API WebSocket (Signalisation)

```typescript
// Connexion
ws://localhost:3001

// Messages de signalisation
{
  type: 'join-room',
  payload: { roomId: string, profile: UserProfile }
}

{
  type: 'webrtc-offer' | 'webrtc-answer' | 'webrtc-ice',
  targetId: string,
  payload: RTCSessionDescription | RTCIceCandidate
}
```

### Endpoints API REST

```bash
# Credentials TURN/STUN
GET /api/turn-credentials?userId=xxx

# G√©olocalisation IP
GET /api/geoip

# Notifications Push
POST /api/save-subscription
```

### Structure de Donn√©es IndexedDB

```typescript
// Stores principaux
- messages: Message[]           // Historique des messages
- conversations: Conversation[] // M√©tadonn√©es conversations
- files: { id: string, blob: Blob }[] // Fichiers locaux
- profile: UserProfile         // Profil utilisateur
- keys: CryptoKeyPair[]        // Cl√©s cryptographiques
```

## üîí S√©curit√©

### Chiffrement End-to-End
- **Algorithme** : AES-GCM 256 bits
- **√âchange de cl√©s** : ECDH P-256
- **D√©rivation** : PBKDF2 avec salt al√©atoire
- **Int√©grit√©** : HMAC-SHA256

### Bonnes Pratiques
- Cl√©s √©ph√©m√®res par session
- Pas de stockage serveur des messages
- Validation stricte des entr√©es
- CSP (Content Security Policy)
- CORS configur√© en whitelist

## üîÆ Roadmap

### Version 1.0 - Base Actuelle ‚úÖ
- [x] **Architecture P2P** : WebRTC avec signalisation WebSocket
- [x] **Chiffrement E2E** : AES-GCM avec cl√©s ECDH
- [x] **G√©olocalisation** : D√©couverte par proximit√© g√©ographique
- [x] **Interface moderne** : React + TypeScript + PWA
- [x] **Stockage local** : IndexedDB avec migrations
- [x] **Transfert fichiers** : Support jusqu'√† 100MB
- [x] **Notes vocales** : Enregistrement et lecture audio
- [x] **Multi-langues** : 5 langues support√©es

### Version 1.1 - S√©curit√© Avanc√©e
- [ ] **Salles th√©matiques** : Chat public par centres d'int√©r√™t
- [ ] **Mod√©ration** : Outils de signalement et blocage

### Version 1.2 - Communication Enrichie
- [ ] **Appels vocaux** : WebRTC audio P2P
- [ ] **Partage d'√©cran** : Collaboration en temps r√©el
- [ ] **Notifications Push** : Service Worker int√©gr√©
- [ ] **Mode hors ligne** : Synchronisation diff√©r√©e

## üêõ Probl√®mes Connus

- **WebRTC NAT** : Peut n√©cessiter serveur TURN en production
- **G√©olocalisation** : Pr√©cision variable selon l'appareil
- **Fichiers volumineux** : Optimisation transfert en cours
- **Navigateurs anciens** : Support limit√© WebRTC/IndexedDB

## üìû Support

- **Issues GitHub** : [Signaler un bug](https://github.com/nonetchat/nonetchat-web/issues)
- **Discussions** : [Forum communautaire](https://github.com/nonetchat/nonetchat-web/discussions)
- **Documentation** : [Wiki technique](https://github.com/nonetchat/nonetchat-web/wiki)
- **Email** : contact@nonetchat.com

## ü§ù Contribution

### Guide de Contribution

1. **Fork** le repository
2. **Cr√©er une branche** : `git checkout -b feature/ma-fonctionnalite`
3. **D√©velopper** avec tests unitaires
4. **Tester** : `npm run test && npm run test:e2e`
5. **Commit** : `git commit -m "feat: ajouter ma fonctionnalit√©"`
6. **Push** : `git push origin feature/ma-fonctionnalite`
7. **Pull Request** avec description d√©taill√©e

### Standards de Code
- **TypeScript strict** : Typage complet
- **ESLint + Prettier** : Formatage automatique
- **Tests obligatoires** : Coverage > 80%
- **Documentation** : JSDoc pour les APIs
- **Commits conventionnels** : feat, fix, docs, etc.

## üìÑ Licence

Ce projet est sous licence **MIT**. Voir le fichier [LICENSE](LICENSE) pour plus de d√©tails.

## üôè Remerciements

- **[WebRTC](https://webrtc.org/)** : Technologie P2P r√©volutionnaire
- **[React](https://reactjs.org/)** : Framework UI moderne
- **[Vite](https://vitejs.dev/)** : Build tool ultra-rapide
- **[TypeScript](https://www.typescriptlang.org/)** : JavaScript typ√©
- **[IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API)** : Base de donn√©es navigateur
- **[MaxMind](https://www.maxmind.com/)** : Base de donn√©es GeoIP
- **Communaut√© open source** : Pour l'inspiration et les contributions

---

**NoNetChat Web** - *Messagerie hyperlocale, s√©curis√©e et respectueuse de la vie priv√©e* üåçüí¨üîí